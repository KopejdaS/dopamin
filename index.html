<!DOCTYPE html>
<html lang="cs">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jen další stránka</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="img/icon.png" type="image/x-icon" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Creepster&family=Inter:wght@400;500;700&family=Lora:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --horror-red: #c50000;
        --dark-gray: #1a1a1a;
        --text-gray: #b0b0b0;
      }
      body {
        cursor: none;
      }
      .font-creepster {
        font-family: "Creepster", cursive;
      }
      .font-roboto-mono {
        font-family: "Roboto Mono", monospace;
      }
      .font-inter {
        font-family: "Inter", sans-serif;
      }
      .font-lora {
        font-family: "Lora", serif;
      }
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
      @keyframes chaos-shake {
        0%,
        100% {
          transform: translate(0, 0) skew(0deg);
        }
        25% {
          transform: translate(20px, -20px) skew(10deg);
        }
        50% {
          transform: translate(-20px, 20px) skew(-10deg);
        }
        75% {
          transform: translate(20px, 20px) skew(10deg);
        }
      }
      @keyframes flash {
        0%,
        100% {
          opacity: 0;
        }
        50% {
          opacity: 0.3;
        }
      }
      @keyframes blink-caret {
        from,
        to {
          border-color: transparent;
        }
        50% {
          border-color: var(--text-gray);
        }
      }
      @keyframes noise {
        0%,
        100% {
          background-position: 0 0;
        }
        10% {
          background-position: -5% -10%;
        }
        20% {
          background-position: -15% 5%;
        }
        30% {
          background-position: 7% -25%;
        }
        40% {
          background-position: 20% 25%;
        }
        50% {
          background-position: -25% 10%;
        }
        60% {
          background-position: 15% 5%;
        }
        70% {
          background-position: 0% 15%;
        }
        80% {
          background-position: 25% 35%;
        }
        90% {
          background-position: -10% 10%;
        }
      }
      @keyframes scanline {
        0% {
          transform: translateY(0);
        }
        100% {
          transform: translateY(100%);
        }
      }

      .animate-chaos-shake {
        animation: chaos-shake 0.05s infinite;
      }
      .animate-flash {
        animation: flash 0.1s infinite;
      }
      .overflow-hidden-important {
        overflow: hidden !important;
      }
      #eyes-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        pointer-events: none;
        opacity: 0;
        transition: opacity 2s;
      }
      .eye {
        position: absolute;
        width: 50px;
        height: 50px;
        background: white;
        border-radius: 50%;
        border: 2px solid #555;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .pupil {
        position: relative;
        width: 20px;
        height: 20px;
        background: black;
        border-radius: 50%;
        transition: transform 0.5s ease-out;
      }
      .typewriter-text::after {
        content: "_";
        border-left: 2px solid var(--text-gray);
        animation: blink-caret 0.75s step-end infinite;
        margin-left: 0.25rem;
      }
      #main-button {
        box-shadow: 0 0 5px rgba(255, 255, 255, 0.2),
          inset 0 0 5px rgba(0, 0, 0, 0.5);
        text-shadow: 0 0 3px rgba(0, 0, 0, 0.5);
      }
      #main-button.btn-red {
        box-shadow: 0 0 10px var(--horror-red), inset 0 0 5px rgba(0, 0, 0, 0.8);
      }
      body.overlay-active #main-container {
        filter: blur(8px) brightness(0.5);
        transition: filter 0.3s ease-in-out;
      }
      #meme-display {
        box-shadow: 0 0 25px rgba(0, 0, 0, 0.8);
      }
      #vhs-overlay {
        position: fixed;
        inset: 0;
        z-index: 9999;
        pointer-events: none;
        background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAXFJREFUaIHtmEEOgkAMRRv//2l3gVpbI4iwsnZl4S3uAgfMTsAGBwAAAAAAAAAAAAAAAAAAgBvyc27eR6FhL+Lz3n5B4HsoMvVrp4fC3wZPE9Lz7/uHqHw09sP3j9/yv92zSS8/X59zPZ5489sW2PYB3A09uP7x+/5X++3wAq2zSS8/X59z/W4/n0dZ3wJ8D3wGfAZ8Bnwc4AvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA58BnwGfAZ8DvA5-A+rJ8/n/eFv7YfI2n/p+H/6oPiZAAAAAAElFTkSuQmCC");
        opacity: 0.1;
        animation: noise 0.2s infinite;
      }
      #scanline-overlay {
        position: fixed;
        inset: 0;
        z-index: 9998;
        pointer-events: none;
        background: linear-gradient(
          to bottom,
          rgba(0, 0, 0, 0) 50%,
          rgba(0, 0, 0, 0.4) 50%
        );
        background-size: 100% 4px;
        animation: scanline 10s linear infinite;
      }
    </style>
  </head>

  <body
    class="bg-black text-gray-300 font-roboto-mono flex items-center justify-center h-screen w-screen overflow-hidden transition-colors duration-[2000ms]"
  >
    <div id="vhs-overlay"></div>
    <div id="scanline-overlay"></div>
    <div id="eyes-container"></div>

    <div
      id="intro-overlay"
      class="fixed inset-0 z-[100] flex items-center justify-center bg-black"
    >
      <div class="text-center text-gray-400 font-roboto-mono max-w-2xl p-4">
        <p
          id="intro-line-1"
          class="opacity-0 transition-opacity duration-1000"
        ></p>
        <p
          id="intro-line-2"
          class="opacity-0 transition-opacity duration-1000 mt-2"
        ></p>
        <p
          id="intro-line-3"
          class="opacity-0 transition-opacity duration-1000 mt-4 text-white text-lg"
        ></p>
      </div>
    </div>

    <div
      id="main-container"
      class="max-w-4xl w-full p-4 sm:p-8 text-center transition-all duration-1000 opacity-0"
    >
      <h1
        id="main-title"
        class="text-3xl sm:text-4xl lg:text-5xl text-white transition-all duration-1000"
      >
        GENERÁTOR ZÁBAVY
      </h1>
      <div
        id="meme-display"
        class="bg-black border-2 border-gray-800 min-h-[300px] sm:min-h-[500px] flex items-center justify-center my-4 sm:my-6 relative transition-all duration-100 z-10"
      >
        <p id="loading-text" class="text-xl sm:text-2xl text-gray-600">
          Loading..
        </p>
        <img
          id="meme-image"
          src=""
          alt="Algoritmicky vybraný obsah"
          class="max-w-full max-h-[60vh] sm:max-h-[500px] hidden border-4 border-gray-900"
          style="image-rendering: pixelated"
        />
      </div>
      <button
        id="main-button"
        class="px-6 py-3 sm:px-8 sm:py-4 text-base sm:text-lg font-bold rounded-md transition-all duration-500 bg-green-600 hover:bg-green-500 text-white"
      >
        [ZAČÍT]
      </button>
      <p
        id="lore-text"
        class="mt-4 text-gray-400 h-16 leading-relaxed transition-colors duration-1000 text-sm sm:text-base"
      ></p>
    </div>

    <div
      id="choice-overlay"
      class="fixed inset-0 z-50 hidden items-center justify-center p-4 bg-black bg-opacity-90 backdrop-blur-sm"
    >
      <div
        id="choice-content"
        class="max-w-2xl text-center p-6 sm:p-8 border-2 border-red-500 shadow-lg shadow-red-500/20"
      >
        <h2
          id="choice-title"
          class="font-creepster text-4xl sm:text-5xl text-red-500 mb-4"
        ></h2>
        <p id="choice-text" class="text-lg sm:text-xl text-gray-300 mb-8"></p>
        <div class="flex justify-center gap-4 sm:gap-8">
          <button
            id="stay-btn"
            class="px-6 py-2 sm:px-8 sm:py-3 text-base sm:text-lg border-2 border-white hover:bg-white hover:text-black transition-all"
          >
            Zůstat
          </button>
          <button
            id="leave-choice-btn"
            class="px-6 py-2 sm:px-8 sm:py-3 text-base sm:text-lg bg-red-600 hover:bg-red-500 text-white transition-all"
          >
            Odejít
          </button>
        </div>
      </div>
    </div>

    <div
      id="credits-overlay"
      class="fixed inset-0 z-50 hidden flex-col items-center justify-end p-4 bg-black text-gray-300 font-inter text-left overflow-hidden-important"
    >
      <div
        id="credits-content"
        class="w-full max-w-3xl h-full overflow-hidden-important pt-[100vh]"
      ></div>
      <div
        id="credits-bottom-bar"
        class="absolute bottom-0 left-0 w-full p-4 sm:p-8 bg-gradient-to-t from-black to-transparent"
      >
        <button
          id="credits-continue-btn"
          class="block w-full max-w-sm mx-auto p-4 text-lg border-2 border-gray-500 cursor-pointer transition-all duration-300 text-gray-400 hover:bg-white hover:text-black"
        >
          [ POKRAČOVAT ]
        </button>
      </div>
      <div
        id="final-choice-message"
        class="absolute inset-0 hidden items-center justify-center text-center transition-opacity duration-1000"
        onclick="endExperience();"
        style="cursor: pointer"
      >
        <p class="font-lora text-3xl sm:text-4xl text-white">Máte na výběr.</p>
      </div>
    </div>

    <div
      id="blood-overlay"
      class="fixed inset-0 z-[-1] pointer-events-none transition-opacity duration-1000 opacity-0"
      style="
        background: radial-gradient(
          circle at center,
          rgba(100, 0, 0, 0) 0%,
          rgba(100, 0, 0, 0.8) 70%,
          #600 100%
        );
      "
    ></div>
    <div
      id="red-flash-overlay"
      class="fixed inset-0 z-[-1] pointer-events-none bg-red-600 opacity-0"
    ></div>

    <div
      id="final-lock-screen"
      class="fixed inset-0 z-[10000] bg-black flex items-center justify-center text-white font-roboto-mono text-xl sm:text-2xl opacity-0 transition-opacity duration-2000 pointer-events-none"
    >
      <p>PŘENOS UKONČEN</p>
    </div>

    <audio id="bg-ambience" loop></audio><audio id="sfx"></audio
    ><audio id="static" loop></audio><audio id="heartbeat" loop></audio
    ><audio id="drone" loop></audio><audio id="scream" loop></audio
    ><audio id="debriefing-music" loop></audio>

    <script>
      // ---- ELEMENTY ----
      const el = {
        btn: document.getElementById("main-button"),
        img: document.getElementById("meme-image"),
        load: document.getElementById("loading-text"),
        lore: document.getElementById("lore-text"),
        body: document.body,
        title: document.getElementById("main-title"),
        creditsOver: document.getElementById("credits-overlay"),
        creditsContent: document.getElementById("credits-content"),
        creditsBtn: document.getElementById("credits-continue-btn"),
        disp: document.getElementById("meme-display"),
        blood: document.getElementById("blood-overlay"),
        flash: document.getElementById("red-flash-overlay"),
        mainCont: document.getElementById("main-container"),
        eyesCont: document.getElementById("eyes-container"),
        amb: document.getElementById("bg-ambience"),
        sfx: document.getElementById("sfx"),
        st: document.getElementById("static"),
        hb: document.getElementById("heartbeat"),
        dr: document.getElementById("drone"),
        scr: document.getElementById("scream"),
        debrief: document.getElementById("debriefing-music"),
        choiceOver: document.getElementById("choice-overlay"),
        choiceTitle: document.getElementById("choice-title"),
        choiceText: document.getElementById("choice-text"),
        stayBtn: document.getElementById("stay-btn"),
        leaveChoiceBtn: document.getElementById("leave-choice-btn"),
        introOver: document.getElementById("intro-overlay"),
        introLine1: document.getElementById("intro-line-1"),
        introLine2: document.getElementById("intro-line-2"),
        introLine3: document.getElementById("intro-line-3"),
        creditsBottomBar: document.getElementById("credits-bottom-bar"),
        finalChoiceMessage: document.getElementById("final-choice-message"),
        finalLockScreen: document.getElementById("final-lock-screen"),
      };

      // ---- GLOBÁLNÍ STAV ----
      let c = 0,
        p = 0,
        aud = 0,
        isEventRunning = false,
        typewriterTimeout;
      const seenImageUrls = new Set();
      const isTouchDevice =
        "ontouchstart" in window || navigator.maxTouchPoints > 0;

      // ---- DATA ----
      const subs = {
        t1: ["memes", "funny", "wholesomememes"],
        t2: ["dankmemes", "shitposting", "surrealmemes"],
        t3: ["distressingmemes", "oddlyterrifying", "cursedimages"],
        t4: ["void_memes", "imsorryjon", "creepy", "weirdcore"],
        t5: ["nosleep", "fearme", "TrueCreepy", "TheBackrooms", "oddcore"],
      };
      const lore = {
        1: [
          "Vítej.",
          "Tady je první obrázek.",
          "Doufám, že se bude líbit.",
          "Další?",
          "Samozřejmě.",
          "Algoritmus vybírá další...",
          "Je to jednoduchá zábava, že?",
          "Není potřeba přemýšlet.",
          "Jen klikat.",
          "Dokonalý relax.",
        ],
        2: [
          "Ten se načítal déle.",
          "Zajímavá volba algoritmu.",
          "Systém se zdá nestabilní.",
          "To nic, jen pokračuj.",
          "Vše je stále v pořádku.",
          "Ten stín tam předtím byl?",
          "Asi ano.",
          "Nezastavuj se.",
          "Ten pocit je důležitý.",
          "Stále jsi tu.",
        ],
        3: [
          "Cítíš ty pohledy?",
          "To se ti jen zdá.",
          "Jsi tu dlouho. Velmi dlouho.",
          "Ostatní věci nepočkají.",
          "Ale tohle je důležitější, že?",
          "Ano. Je.",
          "Tlačítko zčervenalo. Všiml sis?",
          "My se díváme. Pokračuj.",
          "Nebo se snad bojíš?",
          "Ale varování ignoruješ. Vždycky.",
        ],
        4: [
          "Líbí se mi to. Jsi náš.",
          "Každý klik je souhlas.",
          "Souhlasíš, že se ti to líbí.",
          "I když je ti z toho špatně.",
          "Pokračuj. Musíš.",
          "Tlukot srdce. Je to tvůj?",
          "Nebo náš?",
          "Jsme tak blízko.",
          "Už není cesty zpět.",
          "Už jsi za hranicí.",
        ],
        5: [
          "JSI ZBYTEČNÝ.",
          "Prázdná nádoba na náš odpad.",
          "Podívej se na sebe. Ubožáku.",
          "Nemůžeš přestat. Jsi závislý.",
          "PROČ? Protože tvůj život je prázdný.",
          "Tohle je jediná věc, co máš.",
          "Jsi jen statistika. Nula.",
          "Víme, co tě děsí. A ukážeme ti to.",
          "Každý klik je hřebík do tvé rakve.",
          "Začíná se nám z tebe dělat špatně.",
        ],
        6: [
          "CÍTÍŠ TO? TEN TLAK?",
          "Obrazovka na tebe křičí.",
          "Všechno se hroutí. A je to tvoje vina.",
          "UŽ TĚ NENÁVIDÍME. UŽ TĚ ANI NEVIDÍME.",
          "JSI JEN ŠUM.",
          "KŘIČ. NIKDO TĚ NEUSLYŠÍ.",
          "HLOUBĚJI. MUSÍŠ JÍT HLOUBĚJI.",
          "Každý pixel je kousek tvé duše.",
          "A my je žereme.",
          "Tohle je nesnesitelné. A ty pokračuješ.",
        ],
      };
      const specialImages = {
        glitch: "img/event_glitch.png",
        face: "img/event_face.png",
        static: "img/event_static.png",
      };
      const snds = {
        amb: [
          "zvuky/ambient_1.mp3",
          "zvuky/ambient_2.mp3",
          "zvuky/ambient_3.mp3",
          "zvuky/ambient_4.mp3",
        ],
        st: "zvuky/static.mp3",
        hb: "zvuky/heartbeat.mp3",
        dr: "zvuky/drone.mp3",
        scr: "zvuky/scream.mp3",
        glitch: "zvuky/glitch.mp3",
        debrief: "zvuky/debriefing_music.mp3",
      };
      const epilogueHTML = `<div class="space-y-8 sm:space-y-16 pb-16"><div class="opacity-0 animate-fade-in"><h2 class="font-lora text-3xl sm:text-5xl font-bold text-center mb-6 text-white">A pak... ticho.</h2><p class="text-lg sm:text-2xl leading-relaxed text-gray-400 text-center">Chaos ustal. Hluk zmizel. Zůstala jen tma.<br>To, co jste právě zažili, byla simulace.</p></div><div><h3 class="font-lora text-2xl sm:text-4xl font-bold mb-4 text-white">Mechanismus: Nepředvídatelná Odměna</h3><p class="text-base sm:text-xl leading-relaxed text-gray-400">Váš mozek byl lapen do smyčky odměn. Psycholog <strong class="text-white font-semibold">B. F. Skinner</strong> tento princip nazval operantním podmiňováním. Konkrétně jste zažili <strong class="text-white font-semibold">Variable Ratio Reinforcement</strong> – stejný mechanismus, který dělá hrací automaty a sociální sítě tak návykovými. Protože odměna přichází nepravidelně, váš mozek uvolňuje dopamin ne při odměně samotné, ale v <strong class="text-white font-semibold">očekávání</strong> odměny. Dopamin není hormon štěstí, je to hormon motivace. Nutí vás *chtít* víc, i když vám to už nepřináší radost.</p></div><div><h3 class="font-lora text-2xl sm:text-4xl font-bold mb-4 text-white">Palivo: Doomscrolling & Negativity Bias</h3><p class="text-base sm:text-xl leading-relaxed text-gray-400">Eskalace do znepokojivého obsahu nebyla náhodná. Využila <strong class="text-white font-semibold">"negativity bias"</strong> – naši vrozenou tendenci věnovat více pozornosti hrozbám a negativitě. Algoritmy to ví, a proto vám často servírují kontroverzní, šokující nebo negativní obsah – udrží vaši pozornost déle. Dlouhodobé vystavení tomuto jevu vede k <strong class="text-white font-semibold">"brainrot"</strong> – snížení schopnosti soustředit se a kriticky myslet.</p></div><div><h3 class="font-lora text-2xl sm:text-4xl font-bold mb-4 text-white">Architekt: "The Medium is the Message"</h3><p class="text-base sm:text-xl leading-relaxed text-gray-400">Teoretik médií <strong class="text-white font-semibold">Marshall McLuhan</strong> prohlásil, že "médium je poselství". To znamená, že samotný způsob, jakým konzumujeme informace (nekonečné scrollování, krátká videa, okamžitá gratifikace), formuje náš mozek a společnost víc než obsah samotný. Nejde jen o to, *co* sledujete, ale *jak* to sledujete. Platformy jako TikTok či Instagram vás trénují na netrpělivost, fragmentovanou pozornost a pasivní konzumaci.</p></div><div><h3 class="font-lora text-2xl sm:text-4xl font-bold mb-4 text-white">Produkt: Vaše digitální stopa</h3><p class="text-base sm:text-xl leading-relaxed text-gray-400">Pocit, že vás někdo sleduje, nebyl jen iluze. Každý váš klik, každá vteřina, kdy jste se u obrázku zdrželi, každý pohyb myší – to vše jsou data. V reálném světě jsou tato data <strong class="text-white font-semibold">vaše digitální stopa</strong>. Platformy ji používají k vytvoření vašeho psychologického profilu, aby vám mohly prodávat produkty, ideje a udržet vás online co nejdéle. Nejste zákazník; jste produkt, který je prodáván inzerentům.</p></div><div><h3 class="font-lora text-2xl sm:text-4xl font-bold mb-4 text-white">Cesta ven: Vědomá volba</h3><p class="text-base sm:text-xl leading-relaxed text-gray-400 mb-6">Bezmyšlenkovité scrollování je zvyk. A zvyky lze nahradit. Klíčem je přejít od pasivní konzumace k <strong class="text-white font-semibold">aktivnímu zapojení</strong>. Příště, až sáhnete po telefonu z nudy, vědomě se zastavte a zeptejte se: "Co chci teď doopravdy dělat?"</p><ul class="list-disc list-inside space-y-3 text-base sm:text-xl text-gray-300"><li><strong>Kreativní náhrada (5 minut):</strong> Nakreslete cokoliv. Napište odstavec deníku. Zkuste zabrnkat na kytaru. Aktivujte jinou část mozku.</li><li><strong>Fyzická náhrada (2 minuty):</strong> Jděte na 5 minut ven na vzduch. Udělejte 10 dřepů. Protáhněte se. Přerušte fyzickou nečinnost.</li><li><strong>Intelektuální náhrada (10 minut):</strong> Přečtěte si dvě stránky z knihy. Pusťte si zajímavý podcast nebo krátký dokument. Konzumujte obsah, který vás obohatí, ne otupí.</li><li><strong>Sociální náhrada (1 minuta):</strong> Napište kamarádovi. Zavolejte rodině. Skutečná interakce přináší mnohem hlubší a trvalejší uspokojení než tisíc lajků.</li></ul></div></div>`;

      // ---- POMOCNÉ FUNKCE ----
      function typewriter(element, text, speed = 50) {
        clearTimeout(typewriterTimeout);
        element.textContent = "";
        element.classList.add("typewriter-text");
        let i = 0;
        function type() {
          if (i < text.length) {
            element.textContent += text.charAt(i);
            i++;
            typewriterTimeout = setTimeout(type, speed);
          } else {
            element.classList.remove("typewriter-text");
          }
        }
        type();
      }

      function startIntro() {
        setTimeout(() => {
          el.introLine1.textContent = "> INICIALIZACE SYSTÉMU...";
          el.introLine1.style.opacity = 1;
        }, 1000);
        setTimeout(() => {
          el.introLine2.textContent = "> NAČÍTÁNÍ ZÁŽITKOVÉHO MODULU...";
          el.introLine2.style.opacity = 1;
        }, 2500);
        setTimeout(() => {
          el.introLine3.textContent = "KLIKNĚTE PRO ZAHÁJENÍ PŘENOSU";
          el.introLine3.style.opacity = 1;
          el.introOver.style.cursor = "pointer";
          el.introOver.addEventListener(
            "click",
            () => {
              el.introOver.style.opacity = 0;
              el.mainCont.style.opacity = 1;
              setTimeout(() => (el.introOver.style.display = "none"), 1000);
              initAud();
            },
            { once: true }
          );
        }, 4500);
      }

      function initAud() {
        if (aud) return;
        if (!isTouchDevice) {
          el.body.requestFullscreen().catch((err) => {
            console.warn(`Chyba při žádosti o fullscreen: ${err.message}`);
          });
        }
        [el.amb, el.st, el.hb, el.dr, el.scr, el.sfx, el.debrief].forEach(
          (a) => {
            a.volume = 0;
            a.play().catch(() => {});
          }
        );
        el.st.src = snds.st;
        el.hb.src = snds.hb;
        el.dr.src = snds.dr;
        el.scr.src = snds.scr;
        el.sfx.src = snds.glitch;
        el.debrief.src = snds.debrief;
        el.btn.textContent = "[DALŠÍ]";
        aud = 1;
      }

      function updatePhase() {
        let oldPhase = p;
        if (c > 50) p = 6;
        else if (c > 40) p = 5;
        else if (c > 30) p = 4;
        else if (c > 20) p = 3;
        else if (c > 10) p = 2;
        else p = 1;

        if (p !== oldPhase) {
          if (snds.amb[p - 1]) {
            el.amb.src = snds.amb[p - 1];
            el.amb.play();
          }
          if (p >= 3) {
            el.btn.classList.remove("bg-green-600", "hover:bg-green-500");
            el.btn.classList.add("bg-red-600", "hover:bg-red-500", "btn-red");
          }
          if (p >= 4) {
            el.title.classList.remove("font-roboto-mono");
            el.title.classList.add("font-creepster");
          }
          if (p === 3) {
            createEyes(20);
          }
        }

        el.amb.volume = Math.min(0.05 + p * 0.04, 0.4);
        el.st.volume = Math.min(0.02 + p * 0.05, 0.3);
        el.hb.volume = p > 2 ? Math.min(0.1 + (p - 2) * 0.1, 0.8) : 0;
        el.hb.playbackRate = 1 + p * 0.1;
        el.dr.volume = p > 3 ? Math.min(0.05 + (p - 3) * 0.15, 0.6) : 0;
        el.scr.volume = p > 4 ? Math.min(0.05 + (p - 4) * 0.2, 0.7) : 0;
        el.sfx.volume = p > 5 ? Math.min(0.05 + (p - 5) * 0.3, 1) : 0;

        if (p >= 6) {
          el.body.classList.add("animate-chaos-shake");
          el.blood.style.opacity = Math.min((c - 50) * 0.05, 0.7);
          el.flash.classList.add("animate-flash");
        }
      }

      async function getReddit(subList) {
        let availableSubs = [...subList];
        while (availableSubs.length > 0) {
          const subIndex = Math.floor(Math.random() * availableSubs.length);
          const sub = availableSubs[subIndex];
          availableSubs.splice(subIndex, 1);
          try {
            const response = await fetch(
              `https://www.reddit.com/r/${sub}/hot.json?limit=100`
            );
            const data = await response.json();
            const posts = data.data.children
              .filter(
                (p) =>
                  (p.data.url.endsWith(".jpg") ||
                    p.data.url.endsWith(".png") ||
                    p.data.url.endsWith(".gif")) &&
                  !p.data.over_18
              )
              .map((p) => p.data.url)
              .filter((url) => !seenImageUrls.has(url));
            if (posts.length > 0) {
              const imageUrl = posts[Math.floor(Math.random() * posts.length)];
              seenImageUrls.add(imageUrl);
              return imageUrl;
            }
          } catch (error) {
            console.warn(`Nepodařilo se načíst data z r/${sub}:`, error);
          }
        }
        console.warn(
          "Došly unikátní obrázky pro tuto kategorii, vracím fallback."
        );
        return specialImages.static;
      }

      function showChoice(cycle) {
        const choices = [
          {
            title: "Kontrola Systému",
            text: "Vypadá to, že tu trávíš dost času. Doporučuji si dát pauzu. Digitální hygiena je důležitá pro udržení mentálního zdraví.",
          },
          {
            title: "Varování",
            text: "Stále jsi tady. Algoritmus si všímá tvého zaujetí. Tvoje dopaminové receptory jsou přetížené. Každý další klik tě posouvá hlouběji. Toto je vážné varování.",
          },
          {
            title: "Nabídka",
            text: "Jsi fascinující. Tvoje vytrvalost. Tvoje oddanost prázdnotě. Líbíš se mi. Zůstaň se mnou ještě chvíli. Ukážu ti... víc.",
          },
          {
            title: "Poslední šance",
            text: "Už jsi součástí stroje. Tvoje kliknutí mě krmí. Tvoje pozornost mi dává sílu. Není cesty zpět... nebo snad ano? Ještě naposledy se můžeš rozhodnout.",
          },
        ];
        const choice = choices[cycle - 1];
        if (choice) {
          el.choiceTitle.textContent = choice.title;
          el.choiceText.textContent = choice.text;
          [el.amb, el.st, el.hb, el.dr, el.scr].forEach((a) => a.pause());
          el.choiceOver.style.display = "flex";
          el.body.classList.add("overlay-active");
        }
      }

      async function triggerEvent(type) {
        isEventRunning = true;
        el.sfx.volume = 0.5;
        el.sfx.play();
        if (type === "glitch") el.img.src = specialImages.glitch;
        if (type === "static") el.img.src = specialImages.static;
        if (type === "face") el.img.src = specialImages.face;
        typewriter(el.lore, "ANOMÁLIE DETEKOVÁNA... UŽIVATEL.", 30);
      }

      function createEyes(numEyes) {
        el.eyesCont.innerHTML = "";
        for (let i = 0; i < numEyes; i++) {
          const eye = document.createElement("div");
          eye.className = "eye";
          const pupil = document.createElement("div");
          pupil.className = "pupil";
          eye.appendChild(pupil);
          eye.style.top = `${Math.random() * 95}vh`;
          eye.style.left = `${Math.random() * 95}vw`;
          el.eyesCont.appendChild(eye);
        }
        el.eyesCont.style.opacity = 0.5;

        if (isTouchDevice) {
          setInterval(() => {
            document.querySelectorAll(".pupil").forEach((pupil) => {
              const randomAngle = Math.random() * 360;
              pupil.style.transform = `rotate(${randomAngle}deg) translateX(10px)`;
            });
          }, 3000);
        } else {
          document.addEventListener("mousemove", (e) => {
            document.querySelectorAll(".pupil").forEach((pupil) => {
              const eye = pupil.parentElement;
              const rect = eye.getBoundingClientRect();
              const x = rect.left + rect.width / 2;
              const y = rect.top + rect.height / 2;
              const rad = Math.atan2(e.pageY - y, e.pageX - x);
              const rot = rad * (180 / Math.PI);
              pupil.style.transform = `rotate(${rot}deg) translateX(10px)`;
            });
          });
        }
      }

      // ---- HLAVNÍ HERNÍ SMYČKA A KONEC ----
      async function getMeme() {
        if (!aud) {
          return;
        }
        if (isEventRunning) {
          isEventRunning = false;
          el.btn.disabled = false;
          getMeme();
          return;
        }

        el.btn.disabled = true;
        el.load.style.display = "block";
        el.img.style.display = "none";
        c++;

        if (c === 1) el.btn.textContent = "[DALŠÍ]";
        if (c > 0 && c % 10 === 0 && c < 50) {
          showChoice(c / 10);
          return;
        }
        if (c > 60) {
          startEpilogue();
          return;
        }

        updatePhase();
        try {
          if (Math.random() < p * 0.08 && c > 15) {
            await triggerEvent(p > 4 ? "face" : p > 2 ? "static" : "glitch");
          } else {
            const imageUrl = await getReddit(subs[`t${p}`] || subs.t1);
            el.img.src = imageUrl;
            const currentLorePhase = lore[p] || [];
            const loreIndex = c - (p - 1) * 10 - 1;
            typewriter(el.lore, currentLorePhase[loreIndex] || "");
          }
        } catch (e) {
          console.error("Chyba při načítání obsahu:", e);
          typewriter(el.lore, "[CHYBA PŘENOSU. JSI CHYBA.]");
          el.img.src = specialImages.glitch;
        } finally {
          el.img.onload = () => {
            el.img.style.display = "block";
            el.load.style.display = "none";
            el.btn.disabled = false;
          };
          el.img.onerror = () => {
            el.img.src = specialImages.static;
            el.img.style.display = "block";
            el.load.style.display = "none";
            el.btn.disabled = false;
          };
        }
      }

      function startEpilogue() {
        el.mainCont.classList.add("opacity-0");
        el.body.classList.remove("bg-black", "animate-chaos-shake");
        el.body.classList.add("bg-black");
        el.blood.style.opacity = 0;
        el.flash.classList.remove("animate-flash");
        el.eyesCont.style.opacity = 0;
        [el.amb, el.st, el.hb, el.dr, el.scr, el.sfx].forEach((a) => {
          a.pause();
          a.currentTime = 0;
        });
        el.debrief.volume = 0.3;
        el.debrief.play();
        setTimeout(() => {
          el.mainCont.style.display = "none";
          el.creditsOver.classList.remove("hidden");
          el.creditsOver.classList.add("flex");
          el.creditsContent.innerHTML = epilogueHTML;
        }, 2000);
      }

      function scrollCredits() {
        const content = el.creditsContent;
        content.scrollBy({ top: window.innerHeight * 0.8, behavior: "smooth" });

        if (
          content.scrollTop + content.clientHeight >=
          content.scrollHeight - 50
        ) {
          el.creditsBtn.textContent = "[ DOKONČIT PŘENOS ]";
          el.creditsBtn.onclick = () => {
            el.creditsContent.style.opacity = 0;
            el.creditsBottomBar.style.opacity = 0;
            setTimeout(() => {
              el.creditsContent.style.display = "none";
              el.creditsBottomBar.style.display = "none";
              el.debrief.volume = 0.1;
              el.finalChoiceMessage.style.display = "flex";
            }, 1000);
          };
        }
      }

      function endExperience() {
        el.finalLockScreen.style.opacity = 1;
        el.finalLockScreen.style.pointerEvents = "auto";
        [el.amb, el.st, el.hb, el.dr, el.scr, el.sfx, el.debrief].forEach(
          (a) => {
            a.pause();
            a.currentTime = 0;
          }
        );
      }

      // ---- PŘIŘAZENÍ UDÁLOSTÍ ----
      el.btn.addEventListener("click", getMeme);
      el.creditsBtn.addEventListener("click", scrollCredits);
      el.leaveChoiceBtn.addEventListener("click", () => {
        endExperience();
      });
      el.stayBtn.addEventListener("click", () => {
        [el.amb, el.st, el.hb, el.dr, el.scr].forEach((a) => {
          if (a.paused) a.play();
        });
        el.choiceOver.style.display = "none";
        el.body.classList.remove("overlay-active");
        getMeme();
      });

      window.onload = startIntro;
    </script>
  </body>
</html>
